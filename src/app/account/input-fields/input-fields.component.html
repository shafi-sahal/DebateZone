<body>
  <form [formGroup]="form" (input)="setDisableButton($event)">
    <mat-form-field>
      <mat-label>Full name</mat-label>
      <input matInput formControlName="name" (input)="name?.setErrors(null)">
    </mat-form-field>
    <p class="invalid"*ngIf="name?.hasError('pattern')">Give a valid name, buddy</p>

    <mat-form-field>
      <mat-label>Username</mat-label>
      <div class="container-input-with-spinner">
        <input matInput formControlName="username">
        <mat-spinner *ngIf="(username?.statusChanges | async) === 'PENDING'" [diameter]="19"></mat-spinner>
      </div>
    </mat-form-field>
    <app-username-validation-errors [errors]="username?.errors"></app-username-validation-errors>
    <p
      *ngIf="usernameStatus === 'VALID'"
      class="valid">
      Username is available!!!
    </p>

    <mat-form-field>
      <mat-label>Email</mat-label>
      <div class="container-input-with-spinner">
        <input #inputEmail matInput type="email" formControlName="email" (input)="email?.setErrors(null)">
        <mat-spinner *ngIf="(email?.statusChanges | async) === 'PENDING'" [diameter]="19"></mat-spinner>
      </div>
    </mat-form-field>
    <div class="invalid">
      <p *ngIf="email?.hasError('pattern')">Give a valid email, buddy</p>
      <p *ngIf="email?.hasError('isDuplicateEmail')">
        An account with the same email already exists
      </p>
    </div>

    <mat-form-field>
      <mat-label>Mobile</mat-label>
      <input matInput formControlName="mobile" readonly>
    </mat-form-field>

    <mat-checkbox color="primary" [checked]="!!sessionService.readKeepUserLoggedIn()">Keep me logged in</mat-checkbox>
    <p class="keep-me-logged-in">Unchecking this will force you to enter your login details whenever you open DebateZone</p>

    <button class="diagonal-rounded-large" mat-raised-button color="primary" [disabled]="shouldDisableButton">Update</button>
  </form>
</body>

